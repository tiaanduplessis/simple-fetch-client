import e from"tenacious-fetch";import t from"lscache";import o from"fast-safe-stringify";import r from"fetch-response-enhancer";import n from"nanomiddleware";import i from"deep-assign";var s={get:"GET",delete:"DELETE",head:"HEAD",options:"OPTIONS",post:"POST",put:"POST",patch:"PATCH"},c=function(t,o){if(void 0===o&&(o={}),!t||"string"!=typeof t)throw new Error("No base URL provided");this.baseURL=t.endsWith("/")?t.slice(0,t.length-1):t,this.fetch=o.fetch||e,this.middlware=new n,this.delayTime=o.delay||!1,this.cacheTime=o.cacheTime,delete o.fetch,this.config=o};c.prototype.delay=function(e){return void 0===e&&(e=1e3),new Promise(function(t){setTimeout(t,e)})},c.prototype.useMiddleware=function(e,t){void 0===t&&(t={}),this.middlware.use(e,t)},c.prototype.request=function(e,n){void 0===e&&(e="");try{var s=this;function c(){if(u.cache){var e=t.get(p);if(null!==e)return s.middlware.run(e)}return Promise.resolve(s.fetch(p,u)).then(function(e){return Promise.resolve(r(e,u)).then(function(e){return e.url=p,u.cache&&t.set(p,e,u.cacheTime||s.cacheTime||5),s.middlware.run(e)})})}var p=""+s.baseURL+e+(n.params?function(e){void 0===e&&(e={});var t=encodeURIComponent;return"?"+Object.keys(e).map(function(o){return t(o)+"="+t(e[o])}).join("&")}(n.params):""),u=i({headers:{Accept:"application/json","Content-Type":"application/json"}},s.config,n);"object"==typeof u.body&&"application/json"===u.headers["Content-Type"]&&(u.body=o(u.body||{}));var d=function(){if(s.delayTime)return Promise.resolve(s.delay(s.delayTime)).then(function(){})}();return d&&d.then?d.then(c):c()}catch(e){return Promise.reject(e)}},c.prototype.get=function(e,t){return void 0===t&&(t={}),this.request(e,i(t,{method:s.get}))},c.prototype.delete=function(e,t){return void 0===t&&(t={}),this.request(e,i(t,{method:s.delete}))},c.prototype.head=function(e,t){return void 0===t&&(t={}),this.request(e,i(t,{method:s.delete}))},c.prototype.options=function(e,t){return void 0===t&&(t={}),this.request(e,i(t,{method:s.options}))},c.prototype.post=function(e,t){return void 0===t&&(t={}),this.request(e,i(t,{method:s.post}))},c.prototype.put=function(e,t){return void 0===t&&(t={}),this.request(e,i(t,{method:s.put}))},c.prototype.patch=function(e,t){return void 0===t&&(t={}),this.request(e,i(t,{method:s.patch}))};export default c;export{s as methods};
//# sourceMappingURL=simple-fetch-client.m.js.map
